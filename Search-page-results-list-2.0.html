<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Search Results</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        #search-results {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
        }
        .college-result {
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .autocomplete-items {
            position: absolute;
            border: 1px solid #d4d4d4;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            background-color: white;
        }
        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
        }
        .autocomplete-items div:hover {
            background-color: #e9e9e9;
        }
        .autocomplete-active {
            background-color: #e9e9e9;
        }
        .search-container {
            position: relative;
            display: inline-block;
            width: 300px;
        }
        nav {
            background-color: #f0f0f0;
            padding: 10px;
        }
        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        nav li {
            display: inline;
            margin-right: 20px;
        }
        .save-button {
            margin-top: 10px;
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        .save-button:disabled {
            background-color: #ccc;
            cursor: default;
        }
    </style>
</head>
<body>
    <p>
        <strong>Search Bar Instructions:</strong> </p>Welcome! here, you can search for anything related to the website. Such as professors, programs, classes, greek life, etc:</p>
        
<br><br>- For colleges in particular, here are some examples of what you can search for: 

        </p></br>- The college name (e.g., "Harvard")</p>- Location (e.g., "Massachusetts"),</p>- Type (e.g., "Private"), acceptance rate (e.g., "5%"),</p>- SAT score (e.g., "1500"),</p>- ACT score (e.g., "34").</p> <br>- <strong>Note:</strong> Type "Home" to go back to the Homepage/Landing page (this page) after searching.
    </p>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="SavedUniversities.html">Saved Universities</a></li>
        </ul>
    </nav>
    <h1>Search Results</h1>

    <div>
        <form id="search-form" action="#" method="get" onsubmit="filterColleges(event)">
            <div class="search-container">
                <input type="text" id="search-input" name="q" placeholder="Enter name, criteria, etc." required>
                <div id="autocomplete-list" class="autocomplete-items"></div>
            </div>
            <input type="submit" value="Search">
        </form>
    </div>

    <div id="search-results"></div>

    <button id="saveButton" class="save-button" onclick="saveUniversity(data-name)" disabled>Save Results</button>

    <div style="height: 500px; overflow-y: scroll; border: 1px solid black; padding: 10px;">
        <ul>
            <li data-name="Harvard University"
                data-location="Cambridge, Massachusetts"
                data-type="Private Ivy League research university"
                data-founded="1636"
                data-acceptance-rate="4.6%"
                data-website="https://www.harvard.edu/"
                data-sat-range="1460-1570"
                data-act-range="33-35">
                <a href="#" onclick="document.getElementById('harvard').showModal()">Harvard University</a>
            </li>
            <li data-name="Stanford University"
                data-location="Stanford, California"
                data-type="Private research university"
                data-founded="1885"
                data-acceptance-rate="4.3%"
                data-website="https://www.stanford.edu/"
                data-sat-range="1420-1570"
                data-act-range="32-35">
                <a href="#" onclick="document.getElementById('stanford').showModal()">Stanford University</a>
            </li>
            <li data-name="Massachusetts Institute of Technology (MIT)"
                data-location="Cambridge, Massachusetts"
                data-type="Private research university"
                data-founded="1861"
                data-acceptance-rate="6.7%"
                data-website="https://www.mit.edu/"
                data-sat-range="1510-1570"
                data-act-range="34-36">
                <a href="#" onclick="document.getElementById('mit').showModal()">Massachusetts Institute of Technology (MIT)</a>
            </li>
            <li data-name="University of California, Berkeley"
                data-location="Berkeley, California"
                data-type="Public research university"
                data-founded="1868"
                data-acceptance-rate="14.5%"
                data-website="https://www.berkeley.edu/"
                data-sat-range="1330-1530"
                data-act-range="29-35">
                <a href="#" onclick="document.getElementById('berkeley').showModal()">University of California, Berkeley</a>
            </li>
            <li data-name="Yale University"
                data-location="New Haven, Connecticut"
                data-type="Private Ivy League research university"
                data-founded="1701"
                data-acceptance-rate="6.1%"
                data-website="https://www.yale.edu/"
                data-sat-range="1460-1570"
                data-act-range="33-35">
                <a href="#" onclick="document.getElementById('yale').showModal()">Yale University</a>
            </li>
            <li data-name="Princeton University"
                data-location="Princeton, New Jersey"
                data-type="Private Ivy League research university"
                data-founded="1746"
                data-acceptance-rate="5.8%"
                data-website="https://www.princeton.edu/"
                data-sat-range="1450-1570"
                data-act-range="32-35">
                <a href="#" onclick="document.getElementById('princeton').showModal()">Princeton University</a>
            </li>
            <li data-name="California Institute of Technology (Caltech)"
                data-location="Pasadena, California"
                data-type="Private research university"
                data-founded="1891"
                data-acceptance-rate="6.4%"
                data-website="https://www.caltech.edu/"
                data-sat-range="1530-1570"
                data-act-range="35-36">
                <a href="#" onclick="document.getElementById('caltech').showModal()">California Institute of Technology (Caltech)</a>
            </li>
            <li data-name="University of Chicago"
                data-location="Chicago, Illinois"
                data-type="Private research university"
                data-founded="1890"
                data-acceptance-rate="6.2%"
                data-website="https://www.uchicago.edu/"
                data-sat-range="1500-1570"
                data-act-range="33-35">
                <a href="#" onclick="document.getElementById('uchicago').showModal()">University of Chicago</a>
            </li>
            <li data-name="Columbia University"
                data-location="New York City, New York"
                data-type="Private Ivy League research university"
                data-founded="1754"
                data-acceptance-rate="5.4%"
                data-website="https://www.columbia.edu/"
                data-sat-range="1450-1560"
                data-act-range="33-35">
                <a href="#" onclick="document.getElementById('columbia').showModal()">Columbia University</a>
            </li>
            <li data-name="University of Pennsylvania"
                data-location="Philadelphia, Pennsylvania"
                data-type="Private Ivy League research university"
                data-founded="1740"
                data-acceptance-rate="7.7%"
                data-website="https://www.upenn.edu/"
                data-sat-range="1460-1570"
                data-act-range="33-35">
                <a href="#" onclick="document.getElementById('upenn').showModal()">University of Pennsylvania</a>
            </li>
        </ul>
    </div>

    <dialog id="harvard">
        <h2>Harvard University</h2>
        <p><strong>Location:</strong> Cambridge, Massachusetts</p>
        <p><strong>Type:</strong> Private Ivy League research university</p>
        <p><strong>Founded:</strong> 1636</p>
        <p><strong>Acceptance Rate:</strong> 4.6%</p>
        <p><strong>SAT Range:</strong> 1460-1570</p>
        <p><strong>ACT Range:</strong> 33-35</p>
        <p><strong>Website:</strong> <a href="https://www.harvard.edu/" target="_blank">https://www.harvard.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('Harvard University')">Save</button>
    </dialog>

    <dialog id="stanford">
        <h2>Stanford University</h2>
        <p><strong>Location:</strong> Stanford, California</p>
        <p><strong>Type:</strong> Private research university</p>
        <p><strong>Founded:</strong> 1885</p>
        <p><strong>Acceptance Rate:</strong> 4.3%</p>
        <p><strong>SAT Range:</strong> 1420-1570</p>
        <p><strong>ACT Range:</strong> 32-35</p>
        <p><strong>Website:</strong> <a href="https://www.stanford.edu/" target="_blank">https://www.stanford.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('Stanford University')">Save</button>
    </dialog>

    <dialog id="mit">
        <h2>Massachusetts Institute of Technology (MIT)</h2>
        <p><strong>Location:</strong> Cambridge, Massachusetts</p>
        <p><strong>Type:</strong> Private research university</p>
        <p><strong>Founded:</strong> 1861</p>
        <p><strong>Acceptance Rate:</strong> 6.7%</p>
        <p><strong>SAT Range:</strong> 1510-1570</p>
        <p><strong>ACT Range:</strong> 34-36</p>
        <p><strong>Website:</strong> <a href="https://www.mit.edu/" target="_blank">https://www.mit.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('Massachusetts Institute of Technology (MIT)')">Save</button>
    </dialog>

    <dialog id="berkeley">
        <h2>University of California, Berkeley</h2>
        <p><strong>Location:</strong> Berkeley, California</p>
        <p><strong>Type:</strong> Public research university</p>
        <p><strong>Founded:</strong> 1868</p>
        <p><strong>Acceptance Rate:</strong> 14.5%</p>
        <p><strong>SAT Range:</strong> 1330-1530</p>
        <p><strong>ACT Range:</strong> 29-35</p>
        <p><strong>Website:</strong> <a href="https://www.berkeley.edu/" target="_blank">https://www.berkeley.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('University of California, Berkeley')">Save</button>
    </dialog>

    <dialog id="yale">
        <h2>Yale University</h2>
        <p><strong>Location:</strong> New Haven, Connecticut</p>
        <p><strong>Type:</strong> Private Ivy League research university</p>
        <p><strong>Founded:</strong> 1701</p>
        <p><strong>Acceptance Rate:</strong> 6.1%</p>
        <p><strong>SAT Range:</strong> 1460-1570</p>
        <p><strong>ACT Range:</strong> 33-35</p>
        <p><strong>Website:</strong> <a href="https://www.yale.edu/" target="_blank">https://www.yale.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('Yale University')">Save</button>
    </dialog>

    <dialog id="princeton">
        <h2>Princeton University</h2>
        <p><strong>Location:</strong> Princeton, New Jersey</p>
        <p><strong>Type:</strong> Private Ivy League research university</p>
        <p><strong>Founded:</strong> 1746</p>
        <p><strong>Acceptance Rate:</strong> 5.8%</p>
        <p><strong>SAT Range:</strong> 1450-1570</p>
        <p><strong>ACT Range:</strong> 32-35</p>
        <p><strong>Website:</strong> <a href="https://www.princeton.edu/" target="_blank">https://www.princeton.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('Princeton University')">Save</button>
    </dialog>

    <dialog id="caltech">
        <h2>California Institute of Technology (Caltech)</h2>
        <p><strong>Location:</strong> Pasadena, California</p>
        <p><strong>Type:</strong> Private research university</p>
        <p><strong>Founded:</strong> 1891</p>
        <p><strong>Acceptance Rate:</strong> 6.4%</p>
        <p><strong>SAT Range:</strong> 1530-1570</p>
        <p><strong>ACT Range:</strong> 35-36</p>
        <p><strong>Website:</strong> <a href="https://www.caltech.edu/" target="_blank">https://www.caltech.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('California Institute of Technology (Caltech)')">Save</button>
    </dialog>

    <dialog id="uchicago">
        <h2>University of Chicago</h2>
        <p><strong>Location:</strong> Chicago, Illinois</p>
        <p><strong>Type:</strong> Private research university</p>
        <p><strong>Founded:</strong> 1890</p>
        <p><strong>Acceptance Rate:</strong> 6.2%</p>
        <p><strong>SAT Range:</strong> 1500-1570</p>
        <p><strong>ACT Range:</strong> 33-35</p>
        <p><strong>Website:</strong> <a href="https://www.uchicago.edu/" target="_blank">https://www.uchicago.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('University of Chicago')">Save</button>
    </dialog>

    <dialog id="columbia">
        <h2>Columbia University</h2>
        <p><strong>Location:</strong> New York City, New York</p>
        <p><strong>Type:</strong> Private Ivy League research university</p>
        <p><strong>Founded:</strong> 1754</p>
        <p><strong>Acceptance Rate:</strong> 5.4%</p>
        <p><strong>SAT Range:</strong> 1450-1560</p>
        <p><strong>ACT Range:</strong> 33-35</p>
        <p><strong>Website:</strong> <a href="https://www.columbia.edu/" target="_blank">https://www.columbia.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('Columbia University')">Save</button>
    </dialog>

    <dialog id="upenn">
        <h2>University of Pennsylvania</h2>
        <p><strong>Location:</strong> Philadelphia, Pennsylvania</p>
        <p><strong>Type:</strong> Private Ivy League research university</p>
        <p><strong>Founded:</strong> 1740</p>
        <p><strong>Acceptance Rate:</strong> 7.7%</p>
        <p><strong>SAT Range:</strong> 1460-1570</p>
        <p><strong>ACT Range:</strong> 33-35</p>
        <p><strong>Website:</strong> <a href="https://www.upenn.edu/" target="_blank">https://www.upenn.edu/</a></p>
        <button onclick="this.closest('dialog').close()">Close</button>
        <button onclick="saveUniversity('University of Pennsylvania')">Save</button>
    </dialog>

    <p style="margin-top: 20px; font-size: 14px; color: #666;">
        Group 5  |  2024
    </p>

    <script>
    // Store all searchable terms
    // Store all searchable terms with their metadata
    function buildSearchableTerms() {
        const searchableTerms = [];
        const collegeElements = document.querySelectorAll('li[data-name]');
    
        collegeElements.forEach(element => {
            const data = element.dataset;
            // Add all searchable fields with type metadata
            searchableTerms.push({
                text: data.name,
                type: 'name'
            });
            searchableTerms.push({
                text: data.location,
                type: 'location'
            });
            searchableTerms.push({
                text: data.type,
                type: 'type'
            });
            searchableTerms.push({
                text: data.acceptanceRate,
                type: 'acceptance'
            });
            searchableTerms.push({
                text: `SAT ${data.satRange}`,
                type: 'sat'
            });
            searchableTerms.push({
                text: `ACT ${data.actRange}`,
                type: 'act'
            });
        });
    
        return searchableTerms;
    }

    function autocomplete(inp) {
        const searchableTerms = buildSearchableTerms();
        let currentFocus = -1;
    
        inp.addEventListener("input", function(e) {
            const val = this.value;
            closeAllLists();
        
            if (!val) { return false; }
            currentFocus = -1;
        
            const autocompleteList = document.getElementById("autocomplete-list");
        
            // Filter matches based on input
            const matches = searchableTerms.filter(term => 
                term.text.toLowerCase().includes(val.toLowerCase())
            ).slice(0, 10); // Limit to top 10 matches
        
            matches.forEach(match => {
                const div = document.createElement("DIV");
                // Highlight matching text
                const matchText = match.text;
                const matchIndex = matchText.toLowerCase().indexOf(val.toLowerCase());
            
                div.innerHTML = matchText.substr(0, matchIndex);
                div.innerHTML += "<strong>" + matchText.substr(matchIndex, val.length) + "</strong>";
                div.innerHTML += matchText.substr(matchIndex + val.length);
            
                // Add type indicator if it's not a college name
                if (match.type !== 'name') {
                    div.innerHTML += ` <span style="color: #666; font-size: 0.9em;">(${match.type})</span>`;
                }
            
                div.addEventListener("click", function(e) {
                    inp.value = matchText;
                    closeAllLists();
                    // Trigger the search
                    filterColleges(new Event('submit'));
                });
            
                autocompleteList.appendChild(div);
            });
        });
    
        // Key navigation
        inp.addEventListener("keydown", function(e) {
            let x = document.getElementById("autocomplete-list");
            if (x) x = x.getElementsByTagName("div");
        
            if (e.keyCode === 40) { // arrow DOWN
                currentFocus++;
                addActive(x);
            } else if (e.keyCode === 38) { // arrow UP
                currentFocus--;
                addActive(x);
            } else if (e.keyCode === 13) { // ENTER
                e.preventDefault();
                if (currentFocus > -1) {
                    if (x) x[currentFocus].click();
                } else {
                    filterColleges(e);
                }
            }
        });
    
        function addActive(x) {
            if (!x) return false;
            removeActive(x);
            if (currentFocus >= x.length) currentFocus = 0;
            if (currentFocus < 0) currentFocus = (x.length - 1);
            x[currentFocus].classList.add("autocomplete-active");
        }
    
        function removeActive(x) {
            for (let i = 0; i < x.length; i++) {
                x[i].classList.remove("autocomplete-active");
            }
        }
    
        function closeAllLists(elmnt) {
            const x = document.getElementById("autocomplete-list");
            while (x && x.firstChild) {
                x.removeChild(x.firstChild);
            }
        }
    
        // Close autocomplete list when clicking outside
        document.addEventListener("click", function (e) {
            if (e.target !== inp) {
                closeAllLists(e.target);
            }
        });
    }

    // Initialize autocomplete when the page loads
    document.addEventListener("DOMContentLoaded", function() {
        autocomplete(document.getElementById("search-input"));
    
        // Check for existing search query in URL
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('q');
    
        if (searchQuery) {
            const searchInput = document.getElementById("search-input");
            searchInput.value = searchQuery;
            filterColleges(new Event('submit'));
        }
    });
    
    function filterColleges(event) {
        if (event) {
            event.preventDefault();
        }

        var input = document.getElementById("search-input").value.toLowerCase().trim();
        var resultsDiv = document.getElementById("search-results");
        resultsDiv.innerHTML = "";

        // Handle "Home" search
        if (input === "home") {
            window.location.href = "index.html";
            return;
        }

        var foundResults = false;
        var dialogs = document.getElementsByTagName('dialog');

        Array.from(dialogs).forEach(dialog => {
            var name = dialog.querySelector('h2').textContent.toLowerCase();
            var location = dialog.querySelector('p:nth-child(2)').textContent.toLowerCase();
            var type = dialog.querySelector('p:nth-child(3)').textContent.toLowerCase();
        
            if (name.includes(input) || location.includes(input) || type.includes(input)) {
                foundResults = true;
                var resultHTML = `
                    <div class="college-result">
                        <h3>${dialog.querySelector('h2').textContent}</h3>
                        ${dialog.innerHTML.split('<button')[0]}
                    </div>
            `   ;
                resultsDiv.innerHTML += resultHTML;
            }
        });

        if (!foundResults) {
            resultsDiv.innerHTML = `
                <div class="alert alert-info" role="alert">
                    No results found for "${input}". Try another search term.
                </div>
        `   ;
        }

        // Update URL with search query
        const newUrl = new URL(window.location.href);
        newUrl.searchParams.set('q', input);
        window.history.pushState({}, '', newUrl);

        // Update save button state
        updateSaveButtonState();
    }

    // Add event listeners when the page loads
    document.addEventListener("DOMContentLoaded", function() {
        // Initialize the save button state
        updateSaveButtonState();
    
        // Add event listener for the search form
        document.getElementById("search-form").addEventListener("submit", filterColleges);
    
        // Add event listener for the save button
        document.getElementById("saveButton").addEventListener("click", saveResults);
    
        // Check for existing search query in URL
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('q');
    
        if (searchQuery) {
            const searchInput = document.getElementById("search-input");
            searchInput.value = searchQuery;
            filterColleges(new Event('submit'));
        }
    });

    let savedUniversities = JSON.parse(localStorage.getItem('savedUniversities')) || [];
    function updateSaveButtonState() {
        const searchResults = document.getElementById('search-results');
        const saveButton = document.getElementById('saveButton');
        const hasResults = searchResults.getElementsByClassName('college-result').length > 0;
        saveButton.disabled = !hasResults;
    }
    function saveUniversity(universityName) {
        if (!savedUniversities.includes(universityName)) {
            savedUniversities.push(universityName);
            localStorage.setItem('savedUniversities', JSON.stringify(savedUniversities));
            alert(universityName + ' saved successfully!');
        } else {
            alert(universityName + ' is already saved!');
        }
    }

    function saveResults() {
        const searchResults = document.getElementById('search-results');
        const collegeResults = searchResults.getElementsByClassName('college-result');
    
        if (collegeResults.length === 0) {
            alert('No results to save!');
            return;
        }
    
        let newSaves = false;
        Array.from(collegeResults).forEach(result => {
            const universityName = result.querySelector('h3').textContent;
            if (!savedUniversities.includes(universityName)) {
                savedUniversities.push(universityName);
                newSaves = true;
            }
        });
    
        if (newSaves) {
            localStorage.setItem('savedUniversities', JSON.stringify(savedUniversities));
            alert('Search results saved successfully!');
        } else {
            alert('All displayed universities were already saved!');
        }
    }

    document.getElementById("search-form").onsubmit = filterColleges;
    </script>
</body>
</html>

